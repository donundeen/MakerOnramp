<script>
class SkillTreeBrowser{
    constructor(){
        this.skillTreeList = [];
        this.student = false;
    }

    load(){
        return new Promise((resolve, reject) => {
            let self = this;
            if(localStorage.allSkillTreeSheetNames){
                console.log("using local storage"); 
                this.skillTreeList = JSON.parse(localStorage.allSkillTreeSheetNames);
                console.log("skill tree list", this.skillTreeList);
                resolve(this.skillTreeList);
            }else{
                google.script.run.withSuccessHandler(function(result) {
                    console.log(" got skill tree listresult from server: " , result);
                    self.skillTreeList = result;
                    localStorage.allSkillTreeSheetNames = JSON.stringify(result);
                    resolve(self.skillTreeList);
                }).getAllSkillTreeSheetNames();
            }
        });
    }

    display(template){
        let html = template(this);
        return html;
    }
}
</script>